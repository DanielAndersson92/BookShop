<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets">
    <!--XHTML page used to show the logged in user's page. Showing owned and
    wanted books and PMs.
    If not logged in user gets redirected to the log in page-->
    <h:head>
            <title>This is your page</title>
    </h:head>
    <h:body>
        <ui:composition template="/WEB-INF/template.xhtml">
            <ui:define name='content'>
                <h:button outcome="add" value="Add book" class="small-button"/>
                <h:panelGrid columns="3" class="panelColumns">
                    <h:outputLabel>
                        <h2 align="center">Wanted books</h2>
                    </h:outputLabel>
                    <h:outputLabel>
                        <h2 align="center">My books for sale</h2>
                    </h:outputLabel>
                    <h:outputLabel>
                        <h2 align="center">My PM</h2>
                    </h:outputLabel>
                    <h:outputLabel>
                        <h:dataTable class='bookTable' var="b" value="#{mypageBB.wanted}">
                            <h:column>
                                <img src="#{resource['img:book.jpg']}" alt="some_text"/> 
                            </h:column>
                            <h:column>
                                <table class="bookTable2">
                                    <thead>
                                        <h:form>
                                        <h:commandLink action="#{bookBB.setBook(b)}" 
                                                       class="booktitle" 
                                                       value="#{b.title}" />
                                        </h:form>
                                    </thead>
                                    <td>
                                        <h:outputText value="#{b.author}"/><br/>
                                        <h:outputText value="#{b.course}"/><br/>
                                        <h:outputText value="#{b.descr}"/><br/>
                                    </td>
                                    <td>
                                        <h:outputText class="bookprice" value="#{b.price}kr"/>
                                    </td>
                                    <td>
                                        <h:form>
                                        <h:commandButton actionListener="#{editBook.setSelected(b.id)}" 
                                                         action="editBook" 
                                                         value="Edit" class="small-button"/>

                                        <h:commandButton actionListener="#{deleteBook.setSelected(b.id)}"      
                                                         action="deleteBook" 
                                                         value="Delete" class="small-button"/>
                                        </h:form>
                                    </td>
                                </table>
                            </h:column>
                        </h:dataTable>
                    </h:outputLabel>
                    <h:outputLabel>
                        <h:dataTable class='bookTable' var="b" value="#{mypageBB.forSale}">
                            <h:column>
                                <img src="#{resource['img:book.jpg']}" alt="some_text"/> 
                            </h:column>
                            <h:column>
                                <table class="bookTable2">
                                    <thead>
                                        <h:form>
                                        <h:commandLink action="#{bookBB.setBook(b)}" 
                                                       class="booktitle" 
                                                       value="#{b.title}" />
                                        </h:form>
                                    </thead>
                                    <td>
                                        <h:outputText value="#{b.author}"/><br/>
                                        <h:outputText value="#{b.course}"/><br/>
                                        <h:outputText value="#{b.descr}"/><br/>
                                    </td>
                                    <td>
                                        <h:outputText class="bookprice" value="#{b.price}kr"/>
                                    </td>
                                    <td>
                                        <h:form>
                                        <h:commandButton actionListener="#{editBook.setSelected(b.id)}" 
                                                         action="editBook" 
                                                         value="Edit" class="small-button"/>

                                        <h:commandButton actionListener="#{deleteBook.setSelected(b.id)}"      
                                                         action="deleteBook" 
                                                         value="Delete" class="small-button"/>
                                        </h:form>
                                    </td>
                                </table>
                            </h:column>
                        </h:dataTable>
                    </h:outputLabel>
                    <h:outputLabel>
                        <h:dataTable var="c" value="#{mypage.conversations}">
                            <h:column>
                                <h:dataTable class="pmTable" var="p" value="#{c.posts.get(0)}">
                                    <h:column rendered="#{p.unread}">
                                            <img src="#{resource['img:unread.png']}" alt="Unread"/>
                                    </h:column>
                                    <h:column>
                                        <div class="author">
                                        <h:outputText value="#{p.author.fname} #{p.author.lname}"/><br/>
                                        </div>
                                        <h:outputText value="#{p.message}"/>
                                    </h:column>
                                </h:dataTable>
                            </h:column>
                        </h:dataTable>
                    </h:outputLabel>
                </h:panelGrid>
                
                
            </ui:define>
        </ui:composition>
    </h:body>
</html>